<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Warisan KL 3D Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.js"></script>
  <link href="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.css" rel="stylesheet" />
  <style>
    body { margin: 0; padding: 0; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }
  </style>
</head>
<body>
  <div id="map"></div>
  <script>
    const map = new maplibregl.Map({
      container: "map",
      style: {
        version: 8,
        sources: {
          "osm-tiles": {
            type: "vector",
            // You need a vector tile source that has building geometry.
            // Example: OpenMapTiles vector tiles (self-hosted or via a provider).
            url: "https://tiles.yourprovider.com/tiles.json"
          }
        },
        layers: [
          // Dark base — e.g. dark land, roads, etc.
          {
            id: "background",
            type: "background",
            paint: {
              "background-color": "#1a1a1a"
            }
          },
          {
            id: "land",
            type: "fill",
            source: "osm-tiles",
            "source-layer": "landcover",
            paint: {
              "fill-color": "#2a2a2a"
            }
          },
          {
            id: "road",
            type: "line",
            source: "osm-tiles",
            "source-layer": "transport",
            paint: {
              "line-color": "#444",
              "line-width": 1
            }
          },
          // 3D buildings — uniform grey
          {
            id: "3d-buildings",
            type: "fill-extrusion",
            source: "osm-tiles",
            "source-layer": "building",
            minzoom: 15,
            paint: {
              "fill-extrusion-color": "#888888",
              "fill-extrusion-height": ["get", "height"],        // or “render_height”
              "fill-extrusion-base": ["get", "min_height"],
              "fill-extrusion-opacity": 0.9
            }
          }
        ],
        // you can set other style properties if needed
      },
      center: [101.698, 3.144],
      zoom: 14,
      pitch: 45,
      bearing: 0,
      maxBounds: [
        [101.686, 3.136],
        [101.710, 3.154]
      ]
    });

    map.on("load", () => {
      // Add popups with data (example)
      new maplibregl.Popup({ closeOnClick: false })
        .setLngLat([101.6956, 3.1479])
        .setHTML("<b>Masjid Jamek Station</b><br>~45,000 passengers/day (source: Rapid Rail dashboard)")
        .addTo(map);

      new maplibregl.Popup({ closeOnClick: false })
        .setLngLat([101.6994, 3.1418])
        .setHTML("<b>Jalan HSS</b><br>~120 F&B outlets (local survey data)")
        .addTo(map);
    });
  </script>
</body>
</html>
